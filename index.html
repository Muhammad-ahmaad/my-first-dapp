<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web3 Mobile Test</title>
    <style>
        body { background-color: aqua; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        button { cursor: pointer; border-radius: 10px; color: black; padding: 20px; background-color: yellowgreen; font-weight: bold; border: none; font-size: 1.2rem; }
        .info { margin-top: 20px; background: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: none; }
    </style>
</head>
<body>

    <button id="connectButton">Connect Wallet</button>

    <div id="infoBox" class="info">
        <p><strong>Address:</strong> <span id="walletAddress"></span></p>
        <p><strong>Balance:</strong> <span id="walletBalance"></span> ETH</p>
    </div>

    <script>
        const btn = document.getElementById('connectButton');
        const infoBox = document.getElementById('infoBox');
        const addrText = document.getElementById('walletAddress');
        const balText = document.getElementById('walletBalance');

        btn.onclick = async () => {
            if (window.ethereum) {
                try {
                    // 1. Request Account
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    const account = accounts[0];

                    // 2. Get Balance (This returns a "Hex" number in Wei)
                    const balanceHex = await window.ethereum.request({
                        method: 'eth_getBalance',
                        params: [account, 'latest']
                    });

                    // 3. Convert Hex Wei to Decimal ETH
                    // 1 ETH = 1,000,000,000,000,000,000 Wei
                    const balanceDecimal = parseInt(balanceHex, 16) / Math.pow(10, 18);

                    // Update UI
                    addrText.innerText = account.substring(0, 6) + "..." + account.substring(38);
                    balText.innerText = balanceDecimal.toFixed(4);
                    infoBox.style.display = "block";
                    btn.innerText = "Connected!";
                } catch (error) {
                    console.error("User denied access", error);
                }
            } else {
                alert("Please open this inside the MetaMask App Browser!");
            }
        };
    </script>
</body>
</html>